import e,{useState as t,useEffect as a,useCallback as n,useRef as r,forwardRef as l,useImperativeHandle as o}from"react";import{InputGroup as c,InputGroupText as s,Input as u,Button as i,Popover as d,PopoverHeader as m,PopoverBody as p}from"reactstrap";import v from"prop-types";var h=t=>{var{children:a,customInputGroup:n,size:r,inputId:l}=t;return null!=n?e.cloneElement(n,{children:a}):e.createElement(c,{size:r,id:l,className:"rdp-input-group"},a)},g=t=>{var{overlayContainerRef:a}=t;return e.createElement("div",{ref:a,className:"rdp-overlay"})},y=t=>{var{inputId:a,name:n,value:r,formattedValue:l,hiddenInputRef:o}=t;return e.createElement("input",{ref:o,type:"hidden",className:"rdp-hidden",id:a,name:n,value:r||"","data-formattedvalue":l})},D=t=>{var{inputValue:a,disabled:n,clearButtonElement:r,onClick:l}=t;return e.createElement("div",{className:"rdp-addon input-group-append"},e.createElement(s,{onClick:()=>n?null:l(),style:{opacity:a&&!n?1:.5,cursor:a&&!n?"pointer":"not-allowed"}},r))};function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(Object(a),!0).forEach((function(t){E(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function E(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var b=t=>{var{customControl:a,controlId:n,value:r,required:l,placeholder:o,inputRef:c,disabled:s,className:i,style:d,autoFocus:m,autoComplete:p,valid:v,invalid:h,onInvalid:g,noValidate:y,onKeyDown:D,onFocus:f,onBlur:E,onChange:b}=t,k="".concat(!0===h?"is-invalid":""," ").concat(!0===v?"is-valid":"");return null!=a?e.cloneElement(a,{id:n,value:r||"",required:l,placeholder:o,ref:c,disabled:s,className:"rdp-form-control ".concat(i||""," ").concat(a.props.className||""," ").concat(k),style:w(w({},a.props.style||{}),d||{}),autoComplete:p,onInvalid:g,noValidate:y,onKeyDown:D,onFocus:f,onBlur:E,onChange:b}):e.createElement(u,{id:n,name:n,value:r||"",required:l,placeholder:o,innerRef:c,disabled:s,type:"text",className:"rdp-form-control ".concat(i||""," ").concat(k),style:d,autoFocus:m,autoComplete:p,onInvalid:g,noValidate:y,onKeyDown:D,onFocus:f,onBlur:E,onChange:b})},k=e=>e?(e.setHours(12-e.getTimezoneOffset()/60),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e):null,C=e=>e?k(new Date(e)):null,M=e=>e?k(e).toISOString():null,Y=(e,t,a)=>{var n=e.getMonth()+1,r=e.getDate();return a.match(/MM.DD.YYYY/)?(n>9?n:"0".concat(n))+t+(r>9?r:"0".concat(r))+t+e.getFullYear():a.match(/DD.MM.YYYY/)?(r>9?r:"0".concat(r))+t+(n>9?n:"0".concat(n))+t+e.getFullYear():e.getFullYear()+t+(n>9?n:"0".concat(n))+t+(r>9?r:"0".concat(r))},x=(e,t)=>null!=e&&""!=e?e:null!=t&&""!=t?t:(()=>{if("object"==typeof window){null==window._reactstrapDatePickerInstance&&(window._reactstrapDatePickerInstance=0);var e=window._reactstrapDatePickerInstance+1;return window._reactstrapDatePickerInstance=e,e}if("object"==typeof process){null==process._reactstrapDatePickerInstance&&(process._reactstrapDatePickerInstance=0);var t=process._reactstrapDatePickerInstance+1;return process._reactstrapDatePickerInstance=t,t}return console.error("Reactstrap Date Picker cannot determine environment (it is neither browser's <window> nor Node's <process>)."),1})().toString(),B=(e,t,a)=>{var n,r=x(e,t),l="rdp-input-group-".concat(r),o=null!=e?e:"rdp-hidden-".concat(r),c="rdp-form-control-".concat(r);return null!=a&&null!=a&&null!==(n=a.props)&&void 0!==n&&n.id&&(c=a.props.id),[l,o,c]},O=(e,t)=>t>1?e.slice(t).concat(e.slice(0,t)):1===t?e.slice(1).concat(e.slice(0,1)):e,N=(e,t)=>{try{var a=new Date(e),n=new Date(t),r=a.getFullYear()==n.getFullYear();return a.getMonth()==n.getMonth()&&r}catch(e){return console.error(e),!0}},P=(e,t)=>{for(var a=e?new Date(e).getFullYear():1970,n=t?new Date(t).getFullYear():2045,r=[],l=a;l<=n;l++)r.push(l);return r},F=n=>{var{displayDate:r,minDate:l,maxDate:o,monthLabels:c,onChangeMonth:s,onChangeYear:i}=n,[d,m]=t(new Date(r).getMonth()),[p,v]=t(new Date(r).getFullYear()),[h,g]=t(P(l,o));a((()=>{m(new Date(r).getMonth()),v(new Date(r).getFullYear())}),[r]),a((()=>{g(P(l,o))}),[l,o]);return e.createElement("div",{className:"rdp-header-pick-month-default",style:{display:"flex",flexFlow:"row",flexWrap:"nowrap"}},e.createElement("div",{className:"rdp-header-pick-month-default-month",style:{flex:"2 1 auto"}},e.createElement(u,{type:"select",name:"rdp-header-pick-month-default-month",style:{lineHeight:"1.5",fontSize:"0.875rem",padding:"0.2rem"},value:d,onChange:e=>{var t=e.target.value;m(t),s(t)}},c.map(((t,a)=>e.createElement("option",{key:"month_".concat(a),value:a},t))))),e.createElement("div",{className:"rdp-header-pick-month-default-year",style:{flex:"1 1 67px"}},e.createElement(u,{type:"select",name:"rdp-header-pick-month-default-year",style:{lineHeight:"1.5",fontSize:"0.875rem",padding:"0.2rem"},value:p,onChange:e=>{var t=e.target.value;v(t),i(t)}},h.map((t=>e.createElement("option",{key:"year".concat(t),value:t},t))))))};function I(n){var{previousButtonElement:r,nextButtonElement:l,pickMonthElement:o,displayDate:c,minDate:s,maxDate:u,onChange:i,monthLabels:d}=n,[m,p]=t(!1),[v,h]=t(!1),[g,y]=t(""),D=o;a((()=>{if(null!=c){p(!!s&&N(c,s)),h(!!u&&N(c,u));try{d&&y("".concat(d[c.getMonth()]," ").concat(c.getFullYear()))}catch(e){console.error(e)}}}),[c,s,u,d]);var f=e=>{var t=new Date(c);t.setMonth(t.getMonth()+e,1),i(t)},w=e=>{var t=new Date(c);t.setMonth(e),i(t)},E=e=>{var t=new Date(c);t.setFullYear(e),i(t)};return e.createElement("div",{className:"rdp-header text-center",style:{display:"flex",flexFlow:"row",flexWrap:"nowrap"}},e.createElement("div",{className:"text-muted rdp-header-previous-wrapper",onClick:()=>f(-1),style:{cursor:"pointer",userSelect:"none",flexBasis:"1.25em",alignSelf:"center"}},m?null:r),e.createElement("div",{className:"rdp-header-pick-month-wrapper",style:{flex:"1 1 auto"}},null==D||"none"===D?e.createElement("div",null,g):"default"===D?e.createElement(F,{displayDate:c,monthLabels:d,minDate:s,maxDate:u,onChangeMonth:e=>w(e),onChangeYear:e=>E(e)}):e.createElement(D,{displayDate:c,minDate:s,maxDate:u,onChangeMonth:e=>w(e),onChangeYear:e=>E(e)})),e.createElement("div",{className:"text-muted rdp-header-next-wrapper",onClick:()=>f(1),style:{cursor:"pointer",userSelect:"none",flexBasis:"1.25em",alignSelf:"center"}},v?null:l))}var S=t=>{var{dayLabels:a,showWeeks:n,cellPadding:r}=t;return e.createElement("thead",null,e.createElement("tr",null,n?e.createElement("td",{className:"text-muted current-week",style:{padding:r}}):null,a.map(((t,a)=>e.createElement("td",{key:a,className:"text-muted",style:{padding:r}},e.createElement("small",null,t))))))},L=()=>e.createElement("td",null),_={normal:"",muted:"text-muted",selected:"bg-primary",current:"text-primary"},j=t=>{var{day:a,mode:n,onDayClick:r,cellPadding:l,roundedCorners:o}=t;return e.createElement("td",{"data-day":a,onClick:e=>{"muted"!=n&&r(e)},style:{cursor:"muted"==n?"default":"pointer",padding:l,borderRadius:o?"5px":"0px"},className:_[n]},a)},T=t=>{var{weekNum:a,cellPadding:n}=t;return e.createElement("td",{style:{padding:n,fontSize:"0.8em",color:"darkgrey"},className:"text-muted"},a)},V=t=>{var{calendarDays:a,showWeeks:n,onDayClick:r,cellPadding:l,roundedCorners:o}=t;return a?e.createElement("tbody",null,a.map(((t,a)=>e.createElement("tr",{key:"rdp_calendar_week_".concat(a)},n?e.createElement(T,{key:"rdp_calendar_week_".concat(a,"_weeknum"),weekNum:t.weekNum,cellPadding:l}):null,t.weekDays.map(((t,n)=>t.inMonth?e.createElement(j,{key:"rdp_calendar_week_".concat(a,"_day_").concat(n),day:t.day,mode:t.mode,onDayClick:r,cellPadding:l,roundedCorners:o}):e.createElement(L,{key:"rdp_calendar_week_".concat(a,"_day_").concat(n)}))))))):e.createElement("tbody",null)},W=t=>{var{dayLabels:a,showWeeks:n,handleTodayClick:r,showTodayButton:l,todayButtonLabel:o}=t;return l?e.createElement("tfoot",null,e.createElement("tr",null,e.createElement("td",{colSpan:a.length+(n?1:0),style:{paddingTop:"9px"}},e.createElement(i,{block:!0,size:"sm",className:"u-today-button",onClick:()=>r()},o)))):null},R=[31,28,31,30,31,30,31,31,30,31,30,31];function z(e,n,r,l,o){var[c,s]=t(void 0),[u,i]=t(void 0),[d,m]=t(void 0),[p,v]=t([]);return a((()=>{e&&(s(e.getFullYear()),i(e.getMonth()))}),[e]),a((()=>{m(function(e,t,a){if(null!=e&&null!=t){var n=new Date(e,t,1),r=a>1?n.getDay()-a+7:1===a?0===n.getDay()?6:n.getDay()-1:n.getDay(),l=R[t];1==t&&(e%4==0&&e%100!=0||e%400==0)&&(l=29);for(var o=(e,t,a)=>e<=l&&(t>0||a>=r),c=a=>{var n=new Date(e,t,a-1,12,0,0,0),r=new Date(n.valueOf()),l=(n.getDay()+6)%7;r.setDate(r.getDate()-l+3);var o=r.valueOf();return r.setMonth(0,1),4!==r.getDay()&&r.setMonth(0,1+(4-r.getDay()+7)%7),1+Math.ceil((o-r)/6048e5)},s=[],u=1,i=0;i<9;i++){for(var d=[],m=0;m<=6;m++)o(u,i,m)?(d.push({inMonth:!0,day:u}),u+=1):d.push({inMonth:!1});var p=c(u);if(s.push({weekDays:d,weekNum:p}),u>l)break}return{year:e,month:t,weeks:s}}}(c,u,o))}),[c,u,o]),a((()=>{v(function(e,t,a,n){if(null==e)return[];var r=[];return e.weeks.map((l=>{var o=l.weekNum,c=l.weekDays.map((r=>{return w(w({},r),{},{mode:r.inMonth?(l=r.day,o=k(new Date(e.year,e.month,l,12,0,0,0)).toISOString(),c=null!=a&&Date.parse(o)<Date.parse(k(new Date(a))),s=null!=n&&Date.parse(o)>Date.parse(k(new Date(n))),u=k(new Date),i=k(new Date(t)),c||s?"muted":Date.parse(o)===Date.parse(i)?"selected":Date.parse(o)===Date.parse(u)?"current":"normal"):void 0});var l,o,c,s,u,i}));r.push({weekNum:o,weekDays:c})})),r}(d,n,r,l))}),[d,n,r,l]),p}var q,A=t=>{var{selectedDate:a,displayDate:n,minDate:r,maxDate:l,onChange:o,dayLabels:c,cellPadding:s,weekStartsOn:u,showTodayButton:i,todayButtonLabel:v,roundedCorners:h,showWeeks:g,monthLabels:y,previousButtonElement:D,nextButtonElement:f,pickMonthElement:w,placement:E,open:b,container:C,target:M,onChangeMonth:Y}=t,x=z(n,a,r,l,u);return e.createElement(e.Fragment,null,e.createElement(d,{className:"rdp-popover ".concat(E),isOpen:b,container:C,target:M,placement:E},e.createElement(m,{tag:"div"},e.createElement(I,{previousButtonElement:D,nextButtonElement:f,pickMonthElement:w,displayDate:n,minDate:r,maxDate:l,onChange:e=>Y(e),monthLabels:y})),e.createElement(p,null,e.createElement("table",{className:"rdp-calendar text-center"},e.createElement(S,{dayLabels:c,showWeeks:g,cellPadding:s}),e.createElement(V,{calendarDays:x,showWeeks:g,onDayClick:e=>{var t=e.currentTarget.getAttribute("data-day"),a=k(new Date(n));a.setDate(t),o(a)},cellPadding:s,roundedCorners:h}),e.createElement(W,{dayLabels:c,showWeeks:g,handleTodayClick:()=>{var e=k(new Date);o(e)},showTodayButton:i,todayButtonLabel:v})))))},G=e=>{var t=Object.prototype.toString.call(e);return"[object AsyncFunction]"===t||"[object Function]"===t||"[object GeneratorFunction]"===t||"[object Proxy]"===t?e():e},H=(e,l,o,c,s)=>{var[u,i]=t(!1),[d,m]=t(G(e)),p=r(),v=r(),h=l||r(),[g,y]=((e,t,a)=>[n((()=>{if(t){var a=document.createEvent("CustomEvent");a.initEvent("Change Date",!0,!1),e.current.dispatchEvent(a),t(a)}}),[e,t]),n((()=>{if(a){var t=document.createEvent("CustomEvent");t.initEvent("Change Date",!0,!1),e.current.dispatchEvent(t),a(t)}}),[e,a])])(h,c,s);a((()=>{function e(e){e.stopPropagation(),u&&v&&v.current&&!v.current.contains(e.target)&&(i(!1),g())}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[u,v,g]);var D=n((()=>{var t=G(e);m(t),i(!0),y()}),[e,y]);return[p,v,h,u,d,D,e=>{u&&!e||(i(!1),g())}]},J=void 0===J?function(){}:J,K=v.oneOfType([v.func,v.shape({current:v.oneOfType([v.instanceOf(J),v.any])})]),Z=v.oneOfType([v.string,v.object]),Q={value:v.string,defaultValue:v.string,id:v.string,name:v.string,dateFormat:v.string,minDate:v.string,maxDate:v.string,clearButtonElement:Z,showClearButton:v.bool},U={clearButtonElement:"×",dateFormat:(q="undefined"!=typeof window&&window.navigator?(window.navigator.userLanguage||window.navigator.language||"").toLowerCase():"",q&&"en-us"!==q?"DD/MM/YYYY":"MM/DD/YYYY"),showClearButton:!0},X={onInvalid:v.func,onChange:v.func,onClear:v.func,onBlur:v.func,onFocus:v.func},$={size:v.string,valid:v.bool,invalid:v.bool,customInputGroup:v.object},ee={autoComplete:v.string,autoFocus:v.bool,disabled:v.bool,noValidate:v.bool,placeholder:v.string,required:v.bool,className:v.string,style:v.object,inputRef:K,customControl:v.object,children:v.oneOfType([v.arrayOf(v.node),v.node])},te={dayLabels:v.array,monthLabels:v.array,weekStartsOn:v.number,showWeeks:v.bool,previousButtonElement:Z,nextButtonElement:Z,pickMonthElement:v.oneOfType([v.string,v.func,v.element]),showTodayButton:v.bool,todayButtonLabel:v.string,roundedCorners:v.bool,cellPadding:v.string,calendarPlacement:v.oneOfType([v.string,v.func]),calendarContainer:v.oneOfType([v.string,K])},ae={cellPadding:"5px",dayLabels:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthLabels:["January","February","March","April","May","June","July","August","September","October","November","December"],previousButtonElement:"<",nextButtonElement:">",pickMonthElement:void 0,calendarPlacement:"bottom",showTodayButton:!1,todayButtonLabel:"Today",showWeeks:!1,roundedCorners:!1},ne=w(w(w(w(w({},Q),X),$),ee),te),re=w(w(w({},U),{autoFocus:!1,disabled:!1,autoComplete:"on",noValidate:!1}),ae);function le(n,r){var{value:l,defaultValue:c,dateFormat:s,weekStartsOn:u,minDate:i,maxDate:d,onChange:m,onFocus:p,onBlur:v,onClear:f,onInvalid:w,id:E,name:k,required:x,placeholder:N,inputRef:P,noValidate:F,valid:I,invalid:S,customInputGroup:L,style:_,className:j,autoComplete:T,autoFocus:V,disabled:W,size:R,customControl:z,showClearButton:q,clearButtonElement:G,previousButtonElement:J,nextButtonElement:K,pickMonthElement:Z,cellPadding:Q,roundedCorners:U,dayLabels:X,monthLabels:$,calendarPlacement:ee,calendarContainer:te,showWeeks:ae,showTodayButton:ne,todayButtonLabel:re,children:le}=n,oe=((e,t)=>{if(e&&t)return"Conflicting DatePicker properties 'value' and 'defaultValue'"})(l,c);if(null!=oe)throw new Error(oe);var[ce,se,ue,ie,de,me,pe]=H(ee,P,0,v,p),[ve,he,ge,ye,De,fe,we,Ee]=((e,n,r,l,o,c,s,u)=>{var[i,d]=t(c.match(/[^A-Z]/)[0]),[m,p]=t(null),[v,h]=t(null),[g,y]=t(null),[D,f]=t(null);a((()=>{d(c.match(/[^A-Z]/)[0])}),[c]),a((()=>{var e,t=n||r,a=C(a),l=C(l),o=C(t),s=M(o),u=t?Y(o,i,c):null;if(o)e=o;else{var d=C((new Date).toISOString());e=a&&Date.parse(a)>=Date.parse(d)?a:l&&Date.parse(l)<=Date.parse(d)?l:d}p(s),h(u),f(o),y(e)}),[n,r,l,o,i,c]);var w=()=>{s?s():(p(null),h(null),f(null),y(null)),u&&u(null,null)},E=e=>{var t=e.replace(new RegExp("[^0-9".concat(i,"]")),"").split(i);c.match(/MM.DD.YYYY/)||c.match(/DD.MM.YYYY/)?(t[0]&&t[0].length>2&&(t[1]=t[0].slice(2)+(t[1]||""),t[0]=t[0].slice(0,2)),t[1]&&t[1].length>2&&(t[2]=t[1].slice(2)+(t[2]||""),t[1]=t[1].slice(0,2)),t[2]&&(t[2]=t[2].slice(0,4))):(t[0]&&t[0].length>4&&(t[1]=t[0].slice(4)+(t[1]||""),t[0]=t[0].slice(0,4)),t[1]&&t[1].length>2&&(t[2]=t[1].slice(2)+(t[2]||""),t[1]=t[1].slice(0,2)),t[2]&&(t[2]=t[2].slice(0,2)));var a=t.join(i);h(a)};return[m,v,g,D,w,()=>{var t=e.current.value,a=t.replace(/(-|\/\/)/g,i).slice(0,10);if(a){var n,r,s;if(c.match(/MM.DD.YYYY/)){if(!a.match(/[0-1][0-9].[0-3][0-9].[1-2][0-9][0-9][0-9]/))return E(t);n=a.slice(0,2).replace(/[^0-9]/g,""),r=a.slice(3,5).replace(/[^0-9]/g,""),s=a.slice(6,10).replace(/[^0-9]/g,"")}else if(c.match(/DD.MM.YYYY/)){if(!a.match(/[0-3][0-9].[0-1][0-9].[1-2][0-9][0-9][0-9]/))return E(t);r=a.slice(0,2).replace(/[^0-9]/g,""),n=a.slice(3,5).replace(/[^0-9]/g,""),s=a.slice(6,10).replace(/[^0-9]/g,"")}else{if(!a.match(/[1-2][0-9][0-9][0-9].[0-1][0-9].[0-3][0-9]/))return E(t);s=a.slice(0,4).replace(/[^0-9]/g,""),n=a.slice(5,7).replace(/[^0-9]/g,""),r=a.slice(8,10).replace(/[^0-9]/g,"")}var d=parseInt(n,10),m=parseInt(r,10),v=parseInt(s,10);if(d>12||m>31)return E(t);var g=l&&Date.parse(t)<Date.parse(l),D=o&&Date.parse(t)>Date.parse(o);if(g||D)return E(t);if(!isNaN(d)&&!isNaN(m)&&!isNaN(v)&&d<=12&&m<=31&&v>999){var b=C(new Date(v,d-1,m,12,0,0,0).toISOString()),k=M(b);f(b),y(b),p(k),u&&u(k,a)}h(a)}else w()},e=>{y(e)},e=>{var t=M(e),a=Y(e,i,c);h(a),f(e),y(e),p(t),u&&u(t,a)}]})(ue,l,c,i,d,s,f,m),[be,ke,Ce]=((e,n,r)=>{var[l,o]=t(B(e,n,r));return a((()=>{o(B(e,n,r))}),[e,n,r]),l})(E,k,z);o(r,(()=>({getValue:()=>ye?ye.toISOString():null,getFormattedValue:()=>ge?he:null,getNode:()=>null==ue?void 0:ue.current})));var Me=((e,n)=>{var[r,l]=t(O(e,n));return a((()=>{l(O(e,n))}),[e,n]),r})(X,u);return e.createElement(h,{customInputGroup:L,size:R,inputId:be},e.createElement(b,{controlId:Ce,customControl:z,value:he||"",required:x,placeholder:N||"",inputRef:ue,disabled:W,className:j,style:_,autoFocus:V,autoComplete:T,onInvalid:w,noValidate:F,valid:I,invalid:S,onFocus:()=>me(),onBlur:e=>{var t;return pe((null==e||null===(t=e.data)||void 0===t?void 0:t.rdp_close_calendar)||!1)},onChange:()=>fe()}),e.createElement(A,{placement:de,open:ie,container:te||se.current,target:Ce,previousButtonElement:J,nextButtonElement:K,pickMonthElement:Z,displayDate:ge,minDate:i,maxDate:d,onChangeMonth:e=>we(e),monthLabels:$,cellPadding:Q,selectedDate:ye,onChange:e=>(Ee(e),void pe(!0)),dayLabels:Me,weekStartsOn:u,showTodayButton:ne,todayButtonLabel:re,roundedCorners:U,showWeeks:ae}),e.createElement(g,{overlayContainerRef:se}),e.createElement(y,{inputId:ke,name:k,value:ve||"",formattedValue:ve?he:"",hiddenInputRef:ce}),q&&!z?e.createElement(D,{inputValue:he,disabled:W,clearButtonElement:G,onClick:()=>De()}):null,le)}var oe=l(le);oe.propTypes=ne,oe.defaultProps=re;export{oe as DatePicker};
